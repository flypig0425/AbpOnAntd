@namespace Zero.Abp.AntdesignUI.Layout
@inherits AntProComponentBase
@using System.Text;

@if (needFixedHeader)
{
    <Header Style="@FixedHeaderStyle"/>
}
<Header Style="@HeaderStyle"
        Class="@HeaderClass">
    @if (isTop && !IsMobile)
    {
        <TopNavHeader Mode="MenuMode.Horizontal" MatchMenuKeys="MatchMenuKeys" MenuData="MenuData"/>
    }
    else
    {
        <GlobalHeader 
        MatchMenuKeys="MatchMenuKeys"
        MenuData="MenuData">
            @HeaderContentRender
        </GlobalHeader>
    }
</Header>

@code {
      [Parameter]public string[] MatchMenuKeys { get; set; } = { };
    [Parameter] public ApplicationMenuItemList MenuData { get; set; }

    [Parameter] public int SiderWidth { get; set; } = 208;
    [Parameter] public bool Collapsed { get; set; }
    [Parameter] public bool IsMobile { get; set; }
    [Parameter] public bool HasSiderMenu { get; set; }
    [Parameter] public RenderFragment HeaderContentRender { get; set; }

    private bool isTop => Layout == Layout.Top;
    private bool needFixedHeader => FixedHeader || Layout == Layout.Mix;
    private int headerHeight => HeaderHeight;

    private bool needSettingWidth => needFixedHeader && HasSiderMenu && !isTop && !IsMobile;
    private string headerWidth => Layout != Layout.Mix && needSettingWidth
      ? $"calc(100% - {(Collapsed ? 48 : SiderWidth)}px)" : "100%";
    private int? headerRight => needFixedHeader ? 0 : null;

    private string HeaderClass => ClassNames(
         ($"{PrefixCls}-fixed-header", needFixedHeader)
       , ($"{PrefixCls}-fixed-header-action", !Collapsed)
       , ($"{PrefixCls}-top-menu", Layout == Layout.Top)
       , ($"{PrefixCls}-header-{NavTheme.Name}", Layout != Layout.Mix)
        );

    private string FixedHeaderStyle =>
    $"height:{headerHeight}px;line-height:{headerHeight}px;background:transparent";

    private string HeaderStyle =>
    $"padding:0px;height:{headerHeight}px;line-height:{headerHeight}px;width:{headerWidth};z-index:{(Layout == Layout.Mix ? 100 : 9)};{(headerRight.HasValue ? $"right:{headerRight}px;" : "")}{Style}";
}